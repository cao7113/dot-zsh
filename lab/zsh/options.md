# zsh options

项需要区分启动模式选项（控制 shell 如何启动）和行为控制选项（控制 shell 运行时的逻辑）。

```
# Skip loading zshrc:
$ zsh -f

zsh -l # --login
```

在 Zsh 中，`zsh -l` 实际上是 `--login` 的简写。理解 `zsh` 的常用选项需要区分**启动模式选项**（控制 shell 如何启动）和**行为控制选项**（控制 shell 运行时的逻辑）。

以下是 `zsh` 最常用的选项分类及其实际应用：

---

### 1. 启动模式选项 (Startup Modes)

这些选项通常在启动 shell 时直接跟在命令后面。

| 选项     | 全称            | 精确含义                                                                                                       |
| -------- | --------------- | -------------------------------------------------------------------------------------------------------------- |
| **`-l`** | `--login`       | **登录 Shell**。强制 Zsh 读取 `/etc/zprofile` 和 `~/.zprofile`。通常用于确保加载完整的环境变量（如 `$PATH`）。 |
| **`-i`** | `--interactive` | **交互式 Shell**。开启后会读取 `~/.zshrc` 并允许输入命令。如果不加这个，通常用于非交互式脚本执行。             |
| **`-c`** | (无)            | **执行命令字符串**。例如 `zsh -c "ls -l"`。执行完后立即退出。                                                  |
| **`-f`** | `--no-rcs`      | **跳过所有配置文件**。不加载 `.zshrc`, `.zprofile` 等。常用于排查是否是配置引起的问题（即“纯净模式”）。        |

---

### 2. 行为控制选项 (Behavioral Options)

这些选项可以在启动时使用（如 `zsh -x`），也可以在运行中的 shell 里通过 `set -o` 或 `setopt` 开启。

#### **调试类（开发者必选）**

- **`-x` (`xtrace`)**: 打印每一行命令在执行前的具体样子（展开后的样子）。
- **场景**：当你不知道脚本里变量为什么变了，用 `zsh -x script.zsh`。

- **`-v` (`verbose`)**: 在执行命令前打印命令原文。
- **`-n` (`no_exec`)**: 检查脚本语法错误但不实际执行。

#### **安全类**

- **`-u` (`nounset`)**: 访问未定义的变量时直接报错，而不是视为空字符串。
- **`-e` (`errexit`)**: 脚本中任何一条命令失败（返回非 0）就立即退出整个脚本。

---

### 3. Zsh 独有的高级选项 (Setopt)

Zsh 有几百个可以用 `setopt` 开启的选项，以下是最经典的：

- **`EXTENDED_GLOB`**: 开启高级通配符。
- 例如：`ls **/*.js` (递归找 JS 文件) 或 `ls ^*.txt` (取反)。

- **`SHARE_HISTORY`**: 多个终端窗口实时共享同一个历史记录文件。
- **`AUTO_CD`**: 输入文件夹名字直接进入，不需要敲 `cd`。
- **`CORRECT`**: 开启拼写纠错。如果你敲了 `sl`，它会问你是不是想敲 `ls`。

---

### 4. 经典组合示例

#### **组合一：调试远程命令**

```zsh
zsh -lx -c "some_command"

```

- `-l`: 确保加载了远程服务器上的环境变量。
- `-x`: 看到命令执行的每一个细节。
- `-c`: 执行完就跑。

#### **组合二：检查脚本逻辑**

```zsh
#!/bin/zsh -eu
# 这是一个安全的脚本开头
# -e: 遇错即停
# -u: 变量未定义即停

```

---

### 5. 如何查看当前开启了哪些选项？

在你的终端里直接输入：

```zsh
# 列出所有已经开启的选项
setopt

# 列出所有选项及其开关状态
setopt -o

```

### 总结

- **日常最常用**：`-l` (登录环境), `-c` (单次执行)。
- **调试最常用**：`-x` (追踪执行)。
- **脚本最常用**：`-e`, `-u` (提高容错)。

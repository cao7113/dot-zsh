# zsh中r是什么?

```
➜  omz git:(main) ✗ which -a r
r: shell built-in command
➜  omz git:(main) ✗ type -a r
r is a shell builtin
```

在 Zsh 中，`r` 是一个非常低调但极度高效的**内置命令（Builtin）**。

简单来说，**`r` 是 `fc -e -` 的别名**。它的核心功能是：**不经过编辑，直接重新执行上一条命令。**

---

### 1. `r` 的三大核心用法

#### A. 重复执行上一条命令

这是最常用的场景。如果你刚刚执行了 `ls -la`，现在想再执行一次：

```zsh
➜  ls -la
➜  r
# 效果等同于按“向上箭头 + 回车”

```

#### B. 替换参数并执行

这是 `r` 最强大的地方。它可以快速修改上一条命令中的某个字符串并立即运行：

```zsh
➜  ping google.com
# 发现打错了，想 ping baidu.com
➜  r google=baidu
# Zsh 会自动执行 ping baidu.com

```

#### C. 执行历史记录中的特定命令

你可以指定命令的开头字符或历史编号：

```zsh
➜  r git   # 执行历史记录中最近一次以 git 开头的命令
➜  r 1234  # 执行历史编号为 1234 的那条命令

```

---

### 2. 它从哪里来？

虽然 `type -a r` 告诉你它是 `builtin`，但它实际上是 `fc` (Fix Command) 命令的一个特殊变体。

在 Zsh 的源码中，`r` 被预定义为 `fc -e -`：

- **`fc`**: 历史记录操作工具。
- **`-e -`**: 指定编辑器（editor）为 `-`，意味着“不调用编辑器，直接运行”。

---

### 3. 为什么 `which -a r` 没显示它是别名？

这是一个 Zsh 的细节：`r` 在 Zsh 中被视为 **"Builtin Alias"**。它不像你在 `.zshrc` 里写的 `alias l='ls'` 那样显眼，而是深度集成在 shell 的执行引擎中。

如果你在 Bash 中查找，可能找不到它；但在 Zsh 和经典的 KornShell (ksh) 中，`r` 是一直存在的标准配置。

---

### 4. 常见“坑”点提示

由于 `r` 是一个如此短的内置命令，它经常会产生**命名冲突**：

- **R 语言用户**：如果你安装了 R 语言统计软件，执行 `r` 本来想启动 R，结果却变成了重复命令。
- **解决方法**：在 `.zshrc` 中添加 `disable r` 来禁用这个内置命令，或者使用全路径 `/usr/local/bin/R`。

- **Ruby 开发**：有些 Ruby 相关的工具也会尝试占用 `r` 这个名字。

### 总结

`r` = **Repeat**。它是 Zsh 极简主义的体现，专门为那些连“向上箭头”都懒得按的键盘侠准备。
